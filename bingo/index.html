<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Bingo Arena - 10 Jogadores</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root { --primary: #e94560; --bg: #1a1a2e; --card-bg: #16213e; --win: #2ecc71; --accent: #f1c40f; --gold: #ffd700; --money: #27ae60; --loss: #ff4757; }
        * { box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; margin: 0; height: 100vh; overflow: hidden; display: flex; flex-direction: column; padding: 5px; }
        #money-toast { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0); z-index: 30000; font-size: 3rem; font-weight: 900; pointer-events: none; opacity: 0; text-shadow: 0 0 20px rgba(0,0,0,0.5); transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); text-align: center; width: 80%; }
        .toast-show { opacity: 1 !important; transform: translate(-50%, -150%) scale(1.2) !important; }
        #auth-overlay, #withdraw-modal, #deposit-modal { position: fixed; top:0; left:0; width: 100%; height: 100%; background: rgba(26, 26, 46, 0.98); z-index: 9998; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        #withdraw-modal, #deposit-modal { z-index: 20000; display: none; background: rgba(0,0,0,0.85); }
        .auth-card { background: var(--card-bg); padding: 25px; border-radius: 12px; border: 2px solid var(--primary); text-align: center; min-width: 320px; max-width: 400px; }
        .auth-input { background: #0f3460; border: 1px solid var(--primary); color: white; padding: 12px; font-size: 1.2rem; width: 100%; text-align: center; margin: 10px 0; border-radius: 8px; outline: none; }
        .pin-mode { letter-spacing: 8px; font-size: 1.8rem; }
        
        .main-layout { display: grid; grid-template-columns: 150px 1fr 150px; gap: 8px; height: 98vh; }
        .panel { background: var(--card-bg); border-radius: 8px; padding: 8px; display: flex; flex-direction: column; border: 1px solid #333; }
        .money-display { background: rgba(39, 174, 96, 0.15); border: 1px solid var(--money); border-radius: 5px; padding: 5px; text-align: center; margin-bottom: 5px; }
        .money-value { font-size: 1.1rem; color: #fff; font-weight: 900; }
        
        /* BotÃ£o Bloquear ajustado para a esquerda */
        .btn-lock-sidebar { background: #333; width: 100%; font-size: 0.6rem; padding: 6px; border-radius: 4px; margin-bottom: 8px; border: 1px solid #444; color: #ccc; }
        .btn-lock-sidebar:hover { background: #444; color: white; }

        #ball { font-size: 2.5rem; color: var(--accent); text-align: center; font-weight: 900; min-height: 50px; }
        .btn-group { display: flex; flex-direction: column; gap: 5px; }
        button { padding: 8px; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; font-size: 0.7rem; color: white; transition: 0.2s; }
        .btn-manual { background: var(--primary); }
        .btn-auto { background: #3498db; }
        .btn-reset { background: #533483; border: 1px solid #7c4dff; margin-top: 5px; }
        .btn-info { background: #444; margin-top: 5px; display: flex; align-items: center; justify-content: center; gap: 5px; }
        .btn-deposit { background: #3498db; }
        .btn-withdraw { background: var(--money); }
        
        .arena { display: grid; grid-template-columns: repeat(5, 1fr); grid-template-rows: repeat(2, 1fr); gap: 6px; align-content: center; }
        .bingo-card { background: var(--card-bg); padding: 4px; border-radius: 6px; border: 1px solid #333; transition: 0.3s; }
        .bingo-card.player { border: 1px solid var(--primary); box-shadow: 0 0 10px rgba(233, 69, 96, 0.3); }
        .grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 2px; }
        .cell { aspect-ratio: 1/1; display: flex; align-items: center; justify-content: center; background: #0f3460; border-radius: 2px; font-size: 0.65rem; font-weight: bold; }
        .cell.marked { background: var(--primary); }
        .cell.line-win { background-color: var(--win) !important; color: #1a1a2e !important; }
        .cell.free { background: #533483; color: var(--accent); }
        .leader-item { display: flex; justify-content: space-between; padding: 4px 6px; border-bottom: 1px solid #0f3460; font-size: 0.65rem; }
        .leader-item.me { background: var(--accent); color: var(--bg); font-weight: 900; border-radius: 4px; }
        .stats-box { background: #0f3460; padding: 5px; border-radius: 4px; text-align: center; margin-bottom: 8px; border-bottom: 2px solid var(--accent); }
        .stats-label { font-size: 0.6rem; color: #aaa; text-transform: uppercase; display: block; }
        .stats-value { font-size: 1.2rem; font-weight: 900; color: var(--accent); }
        .security-info { font-size: 0.65rem; color: #888; margin-top: 10px; line-height: 1.2; }
    </style>
</head>
<body>
    <div id="money-toast"></div>
    
    <div id="deposit-modal"><div class="auth-card" style="border-color: #3498db;"><h2 style="color: #3498db; margin: 0;">DEPOSITAR VIA PIX</h2><div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin: 15px 0;"><button id="dep-10" style="background:#3498db; padding:15px;">R$ 10</button><button id="dep-50" style="background:#3498db; padding:15px;">R$ 50</button><button id="dep-100" style="background:#3498db; padding:15px;">R$ 100</button></div><button id="close-dep" style="background: #555; width: 100%; padding: 12px;">VOLTAR</button></div></div>
    <div id="withdraw-modal"><div class="auth-card"><h2 style="color: var(--win); margin: 0;">SAQUE VIA PIX</h2><p style="font-size: 0.8rem; color: #ccc;">Saldo: <span id="wd-balance" style="color:white">R$ 0,00</span></p><input type="text" id="pix-key" placeholder="Chave Pix" class="auth-input"><input type="number" id="withdraw-amount" placeholder="Valor (Min: R$ 20)" class="auth-input"><div style="display: flex; gap: 10px; margin-top: 10px;"><button id="close-wd" style="background: #555; flex: 1; padding: 12px;">VOLTAR</button><button id="confirm-wd" style="background: var(--money); flex: 1; padding: 12px;">SACAR</button></div></div></div>

    <div id="auth-overlay">
        <div class="auth-card">
            <h2 id="auth-title">ACESSO Ã€ CARTEIRA</h2>
            <p id="auth-instruction" style="font-size: 0.8rem; color: var(--accent); margin-bottom: 15px;">Defina seu PIN de 4 dÃ­gitos</p>
            <input type="password" id="pass-input" class="auth-input pin-mode" maxlength="4" inputmode="numeric">
            <button id="btn-unlock" style="background: var(--primary); width: 100%; font-size: 1rem; padding: 12px; margin-top: 10px; border-radius: 4px; font-weight: bold; color:white; cursor:pointer">CONFIRMAR PIN</button>
        </div>
    </div>

    <div class="main-layout">
        <div class="panel">
            <div class="money-display">
                <div class="money-value" id="balance">R$ --,00</div>
            </div>
            <button id="btn-logout" class="btn-lock-sidebar">ðŸ”’ BLOQUEAR AGORA</button>
            
            <span id="ball">--</span>
            
            <div class="btn-group">
                <button id="draw-btn" class="btn-manual">SORTEAR</button>
                <button id="auto-btn" class="btn-auto">AUTO</button>
                <button id="new-round-btn" class="btn-reset">NOVA RODADA (R$ 5)</button>
            </div>
            <div id="history-grid" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 2px; overflow-y: auto; padding: 4px; background: #0f3460; border-radius: 4px; flex-grow: 1; margin-top: 5px;"></div>
        </div>

        <div class="arena" id="arena"></div>

        <div class="panel">
            <div class="stats-box">
                <span class="stats-label">Sorteados</span>
                <span id="balls-count" class="stats-value">0</span>
            </div>
            <h3 style="margin:0; font-size: 0.7rem; text-align: center;">RANKING</h3>
            <div id="leader-list" style="margin-top: 5px; flex-grow: 1; overflow-y: auto;"></div>
            
            <div style="margin-top: 10px;">
                <button id="manual-btn" class="btn-info">SOBRE(AJUDA) <span>&#10064;</span></button>
                <button id="open-dep" class="btn-info btn-deposit">DEPOSITAR <span>ðŸ’¸</span></button>
                <button id="open-wd" class="btn-info btn-withdraw">SACAR <span>ðŸ’¸</span></button>
            </div>
        </div>
    </div>

<script>
(function() {
    const somSorteio = new Audio('sorteio.mp3');
    const somDinheiro = new Audio('dinheiro.mp3');
    const somMarca = new Audio('marca.mp3');
    const somBingo = new Audio('bingo.mp3');
    const somLinha = new Audio('linha.mp3');
    const somGeral = new Audio('geral.mp3');

    let drawn = [], players = [], firstLineOut = false, gameOver = false, autoInterval = null;
    let totalBalance = 0;
    let costDeducted = false;
    
    const ROUND_COST = 5.00, LINE_PRIZE = 10.00, BINGO_PRIZE = 20.00;
    const nomesComuns = ["JOÃƒO", "MARIA", "PEDRO", "ANA", "LUCAS", "CARLA", "BRUNO", "JULIA", "MARCOS", "BEATRIZ"];

    function updateBalanceDisplay() {
        document.getElementById('balance').innerText = `R$ ${totalBalance.toFixed(2).replace('.', ',')}`;
        localStorage.setItem('bingo_arena_balance', totalBalance.toString());
    }

    function drawBall() {
        if(gameOver || drawn.length >= 75) return;
        somSorteio.currentTime = 0; somSorteio.play().catch(()=>{});
        let b; do { b = Math.floor(Math.random() * 75) + 1; } while(drawn.includes(b));
        drawn.push(b);
        document.getElementById('ball').innerText = b;
        document.getElementById('balls-count').innerText = drawn.length;
        
        let h = document.createElement('div'); h.style = "background: rgba(255,255,255,0.1); border-radius: 2px; font-size: 0.65rem; text-align: center;";
        h.innerText = b; document.getElementById('history-grid').prepend(h);
        
        document.querySelectorAll(`[data-num="${b}"]`).forEach(c => c.classList.add('marked'));

        players.forEach(p => { 
            if(p.nums.includes(b)) {
                p.marks++; 
                if(p.id === 1) { somMarca.currentTime = 0; somMarca.play().catch(() => {}); }
            }
        });
        
        let sorted = [...players].sort((a,b) => b.marks - a.marks);
        let list = document.getElementById('leader-list'); list.innerHTML = "";
        sorted.forEach(p => list.innerHTML += `<div class="leader-item ${p.id===1?'me':''}"><span>${p.name}</span><span>${p.marks}/25</span></div>`);
        
        players.forEach(p => {
            if(!firstLineOut) {
                for(let r=0; r<5; r++) {
                    let win = true, lCells = [];
                    for(let c=0; c<5; c++) { 
                        let cell = document.getElementById(`p${p.id}-c${r*5+c}`);
                        lCells.push(cell); if(!cell.classList.contains('marked')) win = false;
                    }
                    if(win) {
                        firstLineOut = true; 
                        lCells.forEach(c => c.classList.add('line-win'));
                        somLinha.play().catch(() => {});
                        if(p.id === 1) { 
                            totalBalance += LINE_PRIZE; 
                            updateBalanceDisplay(); 
                            showToast(`LINHA! +R$ 10,00`, "var(--win)");
                        }
                    }
                }
            }

            if(p.marks === 25 && !gameOver) {
                gameOver = true; 
                if(autoInterval) { clearInterval(autoInterval); autoInterval = null; document.getElementById('auto-btn').innerText = "AUTO"; }
                if(p.id === 1) { totalBalance += BINGO_PRIZE; updateBalanceDisplay(); somBingo.play().catch(()=>{}); }
                confetti({ particleCount: 250, spread: 100, origin: { y: 0.5 } });
            }
        });
    }

    function initGame() {
        const arena = document.getElementById('arena'); arena.innerHTML = ""; players = [];
        let nomes = [...nomesComuns].sort(() => Math.random() - 0.5);
        for(let i=1; i<=10; i++) {
            let n = []; while(n.length < 24) { let r = Math.floor(Math.random() * 75) + 1; if(!n.includes(r)) n.push(r); } n.splice(12, 0, 0);
            let p = { id: i, name: i === 1 ? "VOCÃŠ" : nomes[i-2], nums: n, marks: 1 };
            players.push(p);
            let card = document.createElement('div'); card.className = `bingo-card ${i===1?'player':''}`; card.id = `card-p${i}`;
            card.innerHTML = `<h5 style="margin:2px 0; font-size:0.75rem; text-align:center;">${p.name}</h5><div class="grid" id="g-${i}"></div>`;
            arena.appendChild(card);
            p.nums.forEach((num, idx) => {
                let cell = document.createElement('div');
                cell.className = 'cell' + (num === 0 ? ' marked free' : '');
                cell.innerText = num === 0 ? 'â˜…' : num;
                cell.id = `p${i}-c${idx}`;
                if(num !== 0) cell.setAttribute('data-num', num);
                document.getElementById(`g-${i}`).appendChild(cell);
            });
        }
    }

    document.getElementById('btn-unlock').onclick = () => {
        const input = document.getElementById('pass-input').value;
        const saved = localStorage.getItem('bingo_vault_pass');
        if (!saved && input.length === 4) { localStorage.setItem('bingo_vault_pass', input); login(); }
        else if (input === saved) { login(); }
        else { alert("PIN incorreto!"); }
    };

    document.getElementById('btn-logout').onclick = () => { sessionStorage.removeItem('bingo_authenticated'); location.reload(); };

    function login() {
        sessionStorage.setItem('bingo_authenticated', 'true');
        document.getElementById('auth-overlay').style.display = 'none';
        const savedB = localStorage.getItem('bingo_arena_balance');
        totalBalance = savedB ? parseFloat(savedB) : 50.00;
        updateBalanceDisplay();
        initGame();
    }

    function showToast(text, color) {
        const toast = document.getElementById('money-toast');
        toast.innerText = text; toast.style.color = color;
        toast.classList.add('toast-show');
        setTimeout(() => toast.classList.remove('toast-show'), 2000);
    }

    document.getElementById('draw-btn').onclick = () => { drawBall(); };
    document.getElementById('auto-btn').onclick = function() {
        if (autoInterval) { clearInterval(autoInterval); autoInterval = null; this.innerText = "AUTO"; }
        else { this.innerText = "PARAR"; autoInterval = setInterval(drawBall, 850); }
    };
    document.getElementById('new-round-btn').onclick = () => { location.reload(); };
    document.getElementById('open-dep').onclick = () => document.getElementById('deposit-modal').style.display = 'flex';
    document.getElementById('close-dep').onclick = () => document.getElementById('deposit-modal').style.display = 'none';
    document.getElementById('dep-50').onclick = () => { totalBalance += 50; updateBalanceDisplay(); document.getElementById('deposit-modal').style.display = 'none'; };
    document.getElementById('open-wd').onclick = () => { document.getElementById('withdraw-modal').style.display = 'flex'; document.getElementById('wd-balance').innerText = `R$ ${totalBalance}`; };
    document.getElementById('close-wd').onclick = () => document.getElementById('withdraw-modal').style.display = 'none';

    if (sessionStorage.getItem('bingo_authenticated') === 'true') login();
})();
</script>
</body>
</html>
